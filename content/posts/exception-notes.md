Title: 关于错误处理的方式
Date: 2013-04-08 12:34
Description: ""
Category: technology
Tags: exception, notes
Slug: exception-notes

以下摘自《代码大全2》第8章防御式编程8.4异常。

##异常：
异常和继承有一点是相同的，即：审慎明智地使用，可以**降低复杂度**；而草率粗心使用时，只会让**代码变地难以理解**。

#####用异常通知程序地其它部分，发生了不可忽视的错误。
提供了一种无法被忽略的错误通知机制。

#####只在真正例外的情况下才抛出异常
再其它编码实践方法无法解决的情况下才使用异常，处理不仅罕见甚至永远不会发生的情况。
一方面提供了处理意料之外的情况的强有力的方法，但同时弱化了封装、增加了复杂性，调用方需要了解代码可能抛出的异常。

####不能用异常来推卸责任
可以在局部处理的错误就应该在局部处理。

####避免在构造和析构函数抛出异常，除非在同一地方捕获。
主要针对c++吧

####在恰当的抽象层次抛出异常
如果决定把一个异常传给调用方，确保异常的抽象层次与接口的抽象层次是一致的。也就不能把底层异常抛出。

####在异常中加入关于导致异常发生的全部信息
主要针对c++

####考虑创建一个集中的异常报告机制
把错误集中在一个全局的错误处理子程序或对象

####把项目对异常的使用标准化
* 为可以抛出哪些种类的异常建立标砖。
* 考虑建立项目的特定异常类，可以作为项目中抛出异常的基类。
* 规定在何种场合允许代码使用throw－catch语句在局部对错误进行处理。
* 规定在何种场合允许代码抛出不在局部对错误进行处理的异常。
* 确定是否使用集中的的异常报考机制。
* 是否在构造和析构函数中使用异常。

####考虑异常的替换方案
仅仅因为编程语言提供了异常处理机制而使用异常，是典型的“为了使用而使用”。在处理错误时，应该自始至终考虑各种错误处理机制：在局部处理错误，使用错误码来传递错误等。__最后请你考虑你的程序是否真的需要异常。__

---


之前摘录这部分是源于讨论出错后使用异常，还是使用返回错误码的形式。其实焦点是围绕模块接口的错误反馈和局部的错误处理两种情况。有时两种情况很混淆，我是觉得使用异常来对局部进行错误处理是个很好的选择，但不宜抛出层次过深。

还有一种情况就是会过度使用异常，表现在使用异常来控制程序逻辑，其实这是不需要的，完全可以通过简单的判断来实现，异常反而会增加复杂度。

